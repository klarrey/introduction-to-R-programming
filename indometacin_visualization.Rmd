---
title: "Pharmacokinetics of Indomethacin"
author: "Enoch Larrey"
date: "2022-11-25"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# 1.0 Introduction

This short project sought to investigate the trends in the level of indomethacin present in the blood plasma of six human subjects administered with 50 mg indomethacin using qualitative approach. Using the r built-in dataset which exists as a dataframe object, several plots including histograms, scatter plots, bar charts among others were generated by employing the ggplot2 package. It was easier to work with the data because it exists as a dataframe object.

For indomethacin to be effective at treating a symptom for which it is administered, it is imperative for it to persist longer in the blood plasma so that it can be transported in the required amounts to the target tissues or organs. Rapid decline in the level of indomethacin in the blood plasma could reduce its efficacy as less of it is available for the target organs or tissues. This is the reason this project was chosen to understand how quickly indomethacin is cleared from the blood plasma of some 6 study subjects.

# 2.0 Data and Analysis

R built-in dataset accessible by the term “Indometh” was used for the course project. The data comprises of 66 rows (observations) and 3 columns (variables). Columns 1 to 3 are named Subject, time and conc. The conc variable contains values for the concentration of indomethacin in the plasma of 6 human subjects administered with 50 mg of the drug and plasma collected at 11 time points.
The r ggplot2 package was used to explore the data.


```{r}
#Understanding the data
data()
head(Indometh)
?Indometh
table(Indometh$Subject)
str(Indometh)
table(Indometh$time)
library(ggplot2)
```
# 3.0 Results and Discussion

# 3.1 Distribution of Indomethacin Concentration in Blood Plasma

It was observed that distribution of the level of indomethacin in the plasma of the 6 human subjects was skewed to the right as illustrated in figures 1 and 2. To conduct any statistical test using this data therefore requires some transformation or normalization process in order to arrive at a reliable conclusion. In figure 2, the distribution of plasma concentration for each subject followed a similar pattern as the overall distribution for the entire dataset.



```{r}
#Overall distribution of the plasma concentration of indometacin
binsize <- diff(range(Indometh$conc))/15

ggplot(Indometh, aes(conc)) + geom_histogram(binwidth = binsize, fill = "orange", colour = "black") +
  xlab("Concentration") + theme_bw() + ggtitle("Plasma Concentration of Indometacin") + theme(plot.title = element_text(family="Times", hjust=0.5))

ggplot(Indometh, aes(x = conc, y= ..density..)) + geom_histogram(binwidth = binsize, fill = "orange", colour = "black") + geom_density() + 
  xlab("Concentration") + ylab("Density") + theme_bw() + ggtitle("Plasma Concentration of Indometacin") + theme(plot.title = element_text(family="Times", hjust=0.5))

```


```{r}
#Subject-wise distribution of the plasma concentration of indometacin

binsize <- diff(range(Indometh$conc))/5
ggplot(Indometh, aes(x=conc)) + geom_histogram(binwidth = binsize, fill = "purple", colour = "black") + facet_grid(Subject ~ .) + theme(strip.background = element_rect(fill = "pink")) +
  xlab("Concentration") + theme_bw() + ggtitle("Plasma Concentration of Indometacin Per Subject") + theme(plot.title = element_text(family="Times", hjust=0.5))

```
# 3.2 Examination of the Distribution of Indomethacin Per Subject

Further exploration of the distribution of the data by boxplot generated for each subject suggested some degree of variability in the distribution of indomethacin level in the plasma of the 6 subjects (figure 3). While subjects 3, 4 and 6 values assumed a wide range, subjects 1, 2, and 5 tend to have a tight range. Again, subjects 3, 4, and 6 seem to have a relatively higher average compared to subjects 1, 3, and 5. This indicates the level of indomethacin in the blood of the subjects differed, but to know whether this variability is significant, appropriate test must be conducted. A few outliers were observed in the plot. These have the potential to affect the conclusions arrived at from this study. 


```{r}
#Amount of indometacin in the blood plasma for each subject

ggplot(Indometh, aes(x = factor(Subject), y = conc, fill = "tomato")) + geom_boxplot() + guides(fill = FALSE) + xlab("Subject") + ylab("Concentration") +
  ggtitle("Plasma Concentration of Indometacin Per Subject") + theme(plot.title = element_text(family="Times", hjust=0.5))

```
# 3.3 Relationship between Time and Indomethacin Concentration

A scatter plot (figure 4) of time against indomethacin concentration for all subjects revealed that over time, the concentration of indomethacin declined. That was expected, as administered medicines are not expected to remain in the body forever, in other words, it should be possible for the body to metabolize and excrete the drug, so it does not become toxic to the body. However, rapid decline too is bad because it reduces the amount of indomethacin available to the target tissue or organ.


```{r}
#Relationship between time and indometacin concentration
ggplot(Indometh, aes(x=time, y=conc)) + geom_point() + stat_smooth(method = lm) + xlab("Time") + ylab("Concentration") +
  ggtitle("Indometacin, Time against Concentration") + theme(plot.title = element_text(family="Times", hjust=0.5))

```
# 3.4 Line Plot of Indomethacin Concentration and Time

Using a line plot for each subject in figure 5, the decline in indomethacin level observed from the scatter plot in figure 4 was further confirmed. From the plot, it appears that subject 3 had a better retention time followed by subject 6, while subject 1 had the least retention time for indomethacin.


```{r}
#Level of indometacin over time per subject
ggplot(Indometh, aes(x=time, y = conc, colour=Subject)) +
  geom_line() + geom_point() + xlab("Time") + ylab("Concentration") +
  ggtitle("Plasma Concentration of Indometacin Over time") + scale_colour_brewer(palette="Set3") +
  theme_bw() +
  theme(plot.title = element_text(family="Times", hjust=0.5))
  

```

# 3.5 Bar Plots of Indomethacin Concentration for Each Subject

Illustration of the blood plasma indomethacin level for each subject showed a similar pattern across subjects, indomethacin level decreased rapidly until 5 hours where the concentration became stable.



```{r}
library(gridExtra)

data <- Indometh
pcsOne <- data[data$Subject == 1,]
s1 <- ggplot(pcsOne, aes(x = factor(time), y=conc)) + geom_bar(stat = "identity", fill = "blue") + theme_bw() + xlab("Time") + ylab("Plasma Concentration") +
  ggtitle("Plasma Concentration of Indometacin\nfor subject 1") + theme(plot.title = element_text(family="Times", hjust=0.5))

pcstwo <- data[data$Subject == 2,]
s2 <- ggplot(pcsOne, aes(x = factor(time), y=conc)) + geom_bar(stat = "identity", fill = "blue") + theme_bw() + xlab("Time") + ylab("Plasma Concentration") +
  ggtitle("Plasma Concentration of Indometacin\nfor subject 2") + theme(plot.title = element_text(family="Times", hjust=0.5))

pcsthree <- data[data$Subject == 3,]
s3 <- ggplot(pcsOne, aes(x = factor(time), y=conc)) + geom_bar(stat = "identity", fill = "blue") + theme_bw() + xlab("Time") + ylab("Plasma Concentration") +
  ggtitle("Plasma Concentration of Indometacin\nfor subject 3") + theme(plot.title = element_text(family="Times", hjust=0.5))

pcsfour <- data[data$Subject == 4,]
s4 <- ggplot(pcsOne, aes(x = factor(time), y=conc)) + geom_bar(stat = "identity", fill = "blue") + theme_bw() + xlab("Time") + ylab("Plasma Concentration") +
  ggtitle("Plasma Concentration of Indometacin\nfor subject 4") + theme(plot.title = element_text(family="Times", hjust=0.5))

pcsfive <- data[data$Subject == 5,]
s5 <- ggplot(pcsOne, aes(x = factor(time), y=conc)) + geom_bar(stat = "identity", fill = "blue") + theme_bw() + xlab("Time") + ylab("Plasma Concentration") +
  ggtitle("Plasma Concentration of Indometacin\nfor subject 5") + theme(plot.title = element_text(family="Times", hjust=0.5))

pcssix <- data[data$Subject == 6,]
s6 <- ggplot(pcsOne, aes(x = factor(time), y=conc)) + geom_bar(stat = "identity", fill = "blue") + theme_bw() + xlab("Time") + ylab("Plasma Concentration") +
  ggtitle("Plasma Concentration of Indometacin\nfor subject 6") + theme(plot.title = element_text(family="Times", hjust=0.5))

grid.arrange(s1, s2, s3, s4, s5, s6, ncol = 2)
```
# 4.0 Conclusion and Future Direction

Through qualitative data analysis with ggplot2 package, we have been able to uncover the decreasing trend in indomethacin concentration for 6 subjects administered with 50 mg of indomethacin. For all subjects, the level of indomethacin was significantly high from 0.25 h up to 0.75 h. We also saw that the indomethacin concentration values for subjects 3, 4, and 6 had a wider range and a relatively higher average compared to subjects 1, 2 and 5. Among the factors that could account for this variability among the subjects is genetic diversity. So, future studies exploring the reason for the variability in indomethacin concentration for each subject should consider genetic variability as a possible cause. Finally, it will be interesting to investigate the sources of the outliers observed in the data.

